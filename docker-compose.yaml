version: '3.4'
services:
  r_base:
    # image: productor
    build:
      context: .
      dockerfile: Dockerfile
    restart: always
    environment:
      R_TEST: testing
    volumes:
      - ./main.R:/home/productor/main.R
      - shiny_logs:/var/log/shiny-server
    user: 'root'
    ports:
      - "80:3000"
    expose:
      - "3000"
    command: ["Rscript", "/home/productor/main.R"]
    # command: ["bash", "/home/productor/startup_script.sh"]
    # command: ["apt-get", "install", "systemctl", "-y"]
    # command: ["ls", "/srv/shiny-server"]
    # command: ["systemctl", "start", "shiny-server", "--verbose"]
    # R -e "shiny::runApp('~/shinyapp')"

volumes:
  shiny_logs:
